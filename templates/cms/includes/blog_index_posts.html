{% load wagtailcore_tags %}

<ul class="{{ class }} no-bullet">
    {% for post in self.get_descendants.live|dictsortreversed:"first_published_at" %}

        <li>
            {% block blog_post_title %}
                <h2 class="posttitle">
                    <a href="{{ post.url }}">{{ post.title }}</a>
                </h2>
                <p>by {{ post.owner.first_name }} {{ post.owner.last_name }}, {{ post.first_published_at|date:"j M Y" }}</p>
                <section class="postcontent">
                    {% for child in post.blogpost.content %} 
                        <p>
                            {% if child.block_type == 'paragraph' %}
                                {% if forloop.first %}
                                {{ child.value|richtext|truncatewords:15 }}
                                {% endif %}
                            {% endif %}
                        </p>
                    {% endfor %}
                </section>
            {% endblock %}
        </li>

    {% empty %}
        <li>Sorry, nothing to show here.</li>
    {% endfor %}
    
</ul>

{% include "cms/includes/pagination.html" with pages=posts %}

