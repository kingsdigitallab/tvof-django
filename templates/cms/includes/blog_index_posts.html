{% load wagtailcore_tags %}

<ul class="{{ class }}">

    {% for post in self.get_descendants|dictsortreversed:"latest_revision_created_at" %}


	{% if post.live %}

    <li>

		{% block blog_post_title %}
		<h2 class="posttitle">
		    <a href="{{ post.url }}">{{ post.title }}</a>
		</h2>
		<p><em>by {{ post.owner.first_name }} {{ post.owner.last_name }}, {{ post.first_published_at }}</em></p>
		<section class="postcontent">
		    {% for child in post.blogpost.content %} 
				<p>
				{% if child.block_type = 'paragraph' %}
					{% if forloop.first %}
					<em>{{ child.value|richtext|truncatewords:15 }}</em>
					{% endif %}
				{% endif %}
				</p>
                    {% endfor %}

		</section>
		{% endblock %}


	{% endif %}

    </li>
    {% empty %}
    <li>Sorry, nothing to show here.</li>



    {% endfor %}

	
</ul>

{% include "cms/includes/pagination.html" with pages=posts %}

